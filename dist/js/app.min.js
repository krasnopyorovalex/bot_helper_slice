!function(){var s,a=jQuery(".body__box-users"),e="admin.jpg",i=jQuery(".header__box-sb-r .fa-star"),t=jQuery(".body__box-dialog"),r=function(){return t.toggleClass("loading")},n=function(a){var i,r,n="";if(s&&a){for(i in s[a].messages)r=parseInt(s[a].messages[i].is_answer)?e:s[a].image,n+='<li><div class="body__box-dialog-avatar"><img alt="ava" src="/images/'+r+'"></div><div class="body__box-dialog-text">'+s[a].messages[i].message+"</div></li>";t.find("ul").html(n)}},d=function(e){if(s){var i,t="";for(i in s){var r=parseInt(s[i].is_favorite)?"is_favorites":"",n=i==e?" active":"",d=parseInt(s[i].status)?'<div class="user__message-status-new"><i class="fa fa-circle" aria-hidden="true"></i></div>':"";t+='<li data-user="'+i+'" class="'+r+n+'"><img src="images/'+s[i].image+'" alt="ava"><div class="user__body"><div class="user__name">'+s[i].name+'<i class="fa fa-star" aria-hidden="true"></i></div><div class="user__last-message">'+s[i].last_message+'</div><div class="user__message-time">'+s[i].time+"</div>"+d+"</div></li>"}a.find("ul").html(t)}},l=function(){var e=parseInt(a.find("li.active").attr("data-user"));jQuery.ajax({url:"/get-messages",method:"post",dataType:"json",data:{userId:parseInt(e)},beforeSend:function(){return r()},success:function(a){return s=a,n(e),d(e),r()}})};a.on("click","li",function(){var s=jQuery(this),a=parseInt(s.attr("data-user"));return s.closest("ul").find("li").removeClass("active"),s.hasClass("is_favorites")?i.addClass("active"):i.removeClass("active"),s.find(".user__message-status-new").remove(),s.addClass("active"),n(a)}),i.on("click",function(){var s=jQuery(this),e=a.find("li.active"),i=parseInt(e.attr("data-user"));return i&&(e.toggleClass("is_favorites"),jQuery.ajax({url:"/set-favorite",method:"post",data:{userId:i,is_favorite:e.hasClass("is_favorites")?1:0},success:function(){return s.toggleClass("active")}})),!0}),l(),setInterval(l,1e4)}();